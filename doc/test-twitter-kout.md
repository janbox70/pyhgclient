# twitter数据集下，kout 性能测试 

## 1-2度， 单节点 (batch-size 默认值： 0.95， 10000，100000000)
### 首次
          cost-1  count-1  iters/s-1  cost-2   count-2  iters/s-2
20727483     158      973       7018    7677   2874132     454517
50329304      64     4746      74390    8792   2714697     424691
26199460     158    19954     220082  102214   7818213    1427606
1177521       46     4272     108000  173360  19318826     744324
27960125       7        7       1428     903    533108     592029
30440025      18     3386     190111   38010  11294131     640053
15833920      40     2181      82975   59264   7858255     518519
15015183      39     2279      89641   60642   5933114     751884
33153097       9      116      16000   41196  12181518     718997
21250581      28       37       1500   33686  11063971     764091
avg	        56.7     3795	   79114   52574   8158996	   703671

## 1-2度， 单节点，  调整 batch-size: 0.1, 1000, 1000000
          cost-1  count-1  iters/s-1  cost-2   count-2  iters/s-2
20727483     146      973       7595    7717   2874132     452161
50329304      59     4746      80694    6852   2714697     542707
26199460     183    19954     190016   75390   7818213    1419650
1177521       48     4272     103500  105478  19318826    1182759
27960125       6        7       1666    1068    533108     500564
30440025      20     3386     171100   22270  11294131    1083783
15833920      37     2181      89702   26072   7858255    1169988
15015183      37     2279      94486   32585   5933114    1361230
33153097       6      116      24000   41150  12181518     719801
21250581      24       37       1750   33652  11063971     764863
avg          56.6    3795      76450   35223   8158996     919750

## 1-2度， 单节点，  调整 batch-size: 0.95, 100, 10000000
### 首次
          cost-1  count-1  iters/s-1  cost-2   count-2  iters/s-2
20727483     131      973       8465    7634   2874132     457077
50329304      42     4746     113357    6631   2714697     561459
26199460     144    19954     241479   38868   7818213    2345069
1177521       31     4272     160258   67314  19318826    1155249
27960125       7        7       1428     867    533108     616612
30440025      20     3386     171100   31600  11294131     768869
15833920      21     2181     158047   31518   7858255     829628
15015183      19     2279     184000   18111   5933114    1816305
33153097       6      116      24000   28997  12181518    1003488
21250581       9       37       4666   35219  11063971     730832
avg	          43     3795     106680   26675   8158996    1028458

### 第二次测试
          cost-1  count-1  iters/s-1  cost-2   count-2  iters/s-2
20727483       7      973     158428    6541   2874132     533455
50329304      18     4746     264500    5837   2714697     636549
26199460     116    19954     299767   43503   7818213    2111266
1177521       20     4272     248400   57318  19318826    1296111
27960125       4        7       2500    1509    533108     354276
30440025      13     3386     263230   44306  11294131     548586
15833920      14     2181     237071   13812   7858255    1748615
15015183      15     2279     233066   16807   5933114    1897113
33153097       4      116      36000   30760  12181518     944050
21250581       4       37      10500   36642  11063971     702450
avg           21     3795     175346   25703   8158996    1077247

### 重复：
          cost-1  count-1  iters/s-1  cost-2   count-2  iters/s-2
20727483       7      973     158428    5281   2874132     660732
50329304      15     4746     317400    4633   2714697     802690
26199460      91    19954     382120   90911   7818213    1005918
1177521       18     4272     276000   75120  19318826    1067122
27960125       4        7       2500     871    533108     613780
30440025      12     3386     285166   30565  11294131     794821
15833920      12     2181     276583   15266   7858255    1587430
15015183      13     2279     268923   23591   5933114    1365751
33153097       4      116      36000   27851  12181518    1045469
21250581       3       37      14000   35144  11063971     732392
avg           17     3795     201712   30923   8158996     967610

          cost-1  count-1  iters/s-1  cost-2   count-2  iters/s-2
20727483      30      973      36966    8369   2874132     416935
50329304      39     4746     122076    5649   2714697     657293
26199460     143    19954     243167   62457   7818213    1329597
1177521       42     4272     118285   62116  19318826    1163830
27960125       4        7       2500    1230    533108     434636
30440025      15     3386     228133   30946  11294131     785167
15833920      37     2181      89702   16427   7858255    1586841
15015183      36     2279      97111   23703   5933114    1305230
33153097       5      116      28800   30752  12181518     944720
21250581      25       37       1680   34141  11063971     753908
avg           37     3795      96842   27579   8158996     937815


## 三节点集群， 调整 batch-size: 0.95, 300, 30000000
### 首次
          cost-1  count-1  iters/s-1  cost-2   count-2  iters/s-2
20727483     499      973       2222    5920   2874132     581892
50329304     329     4746      14471    6868   2714697     539145
26199460     574    19954      60580   34216   7818213    2190827
1177521       65     4272      76430   53531  19318826    1368346
27960125      15        7        666     869    533108     614779
30440025      28     3386     122214   17832  11294131    1298682
15833920     444     2181       7475   12910   7858255    1819929
15015183      70     2279      49942   19252   5933114    1232650
33153097      16      116       9000   24679  12181518    1174479
21250581      47       37        893   20716  11063971    1223890
avg          208     3795      34389   19679   8158996    1204461

### 第二次
          cost-1  count-1  iters/s-1  cost-2   count-2  iters/s-2
20727483       8      973     138625    4029   2874132     857171
50329304      18     4746     264500    4502   2714697     816957
26199460      90    19954     386366   56080   7818213    1057044
1177521       18     4272     276000   56713  19318826    1223933
27960125       4        7       2500     944    533108     565556
30440025      12     3386     285166   15544  11294131    1485335
15833920      13     2181     255307   12409   7858255    1778018
15015183      13     2279     268923   14756   5933114    1691970
33153097       4      116      36000   22796  12181518    1270136
21250581       8       37       5250   20427  11063971    1199391
avg           18     3795     191863   20820   8158996    1194551

## 三节点集群， 调整 batch-size: 0.95, 300, 10000000
### 首次
          cost-1  count-1  iters/s-1  cost-2   count-2  iters/s-2
20727483     171      973       6485    5521   2874132     620379
50329304      62     4746      76790    6446   2714697     572128
26199460     156    19954     222903   37090   7818213    2781803
1177521       41     4272     121170   54332  19318826    1116811
27960125      16        7        625    1512    533108     353311
30440025      30     3386     114066   16259  11294131    1370186
15833920      33     2181     100575   26050   7858255    1128077
15015183      30     2279     116533   27275   5933114     941707
33153097      15      116       9600   20941  12181518    1382518
21250581      17       37       2470   18654  11063971    1345656
avg           57     3795      77121   21408   8158996    1161257

### 重测（
          cost-1  count-1  iters/s-1  cost-2   count-2  iters/s-2
20727483     171      973       6485    5780   2874132     595511
50329304      65     4746      73246    6139   2714697     601904
26199460     173    19954     201000   41242   7818213    2626880
1177521       42     4272     118285   53271  19318826     920638
27960125      16        7        625    1173    533108     455413
30440025      38     3386      90052   16839  11294131    1361769
15833920      29     2181     114448   14646   7858255    1484731
15015183      27     2279     129481   17787   5933114    1215168
33153097      14      116      10285   21908  12181518    1321559
21250581      16       37       2625   23956  11063971    1050050
avg           59     3795      74653   20274   8158996    1163362


## 三节点集群， batch-size: 0.1, 1000, 10000000
          cost-1  count-1  iters/s-1  cost-2   count-2  iters/s-2
20727483      40      973      27725    4498   2874132     757141
50329304      29     4746     164172    6053   2714697     602574
26199460     118    19954     294686   37816   7818213    2445191
1177521       40     4272     124200   51547  19318826    1994395
27960125       5        7       2000     841    533108     635215
30440025      16     3386     213875   13791  11294131    1588783
15833920      19     2181     174684   19029   7858255    1494175
15015183      32     2279     109250   14807   5933114    2530081
33153097       5      116      28800   23870  12181518    1191629
21250581      23       37       1826   18923  11063971    1336151
avg           32     3795     114121   19117   8158996    1457533


## 上限 80万（与开源对比）
### 分布式版本（服务器计时）
          cost-1  count-1  iters/s-1   cost-2   count-2  iters/s-2
20727483    70.0    973.0    15842.0   1620.0  799026.0   638120.0
50329304    40.0   4746.0   119025.0   1430.0  795253.0   655734.0
26199460   109.0  19954.0   319018.0  11879.0  780045.0   389774.0
1177521    249.0   4272.0    19951.0      NaN       NaN        NaN
27960125     7.0      7.0     1428.0    897.0  533108.0   595697.0
30440025    15.0   3386.0   228133.0   1508.0  796613.0   546673.0
15833920    30.0   2181.0   110633.0   3385.0  797818.0   507173.0
15015183    31.0   2279.0   112774.0   4660.0  797720.0   246045.0
33153097     6.0    116.0    24000.0   1187.0  799883.0   713346.0
21250581    22.0     37.0     1909.0   1195.0  799962.0   737415.0
avg         57.0   3795.0    95271.0   3084.0  766603.0   558886.0


          cost-1  count-1  iters/s-1  cost-2  count-2  iters/s-2
20727483      10      973     110900    1553   799026     657714
50329304      20     4746     238050    1409   795253     667151
26199460     103    19954     337601   11694   780045     390216
1177521       19     4272     261473    5746   795727     149954
27960125       6        7       1666     906   533108     589547
30440025      13     3386     263230    1611   796613     513862
15833920      18     2181     184388    4958   797818     347108
15015183      14     2279     249714    4755   797720     240843
33153097       6      116      24000    1157   799883     744017
21250581       6       37       7000    1129   799962     758886
avg           21     3795     167802    3491   769515     505929

### 开源版本（本地计时，多一个网络传输时间）
          cost-1  count-1  iters/s-1  cost-2  count-2  iters/s-2
20727483      32      973          0    1581   799026          0
50329304      31     4746          0    1938   795253          0
26199460      82    19954          0    8002   780045          0
1177521       23     4272          0    1590   795727          0
27960125      11        7          0    1097   533108          0
30440025      23     3386          0    1861   796613          0
15833920      28     2181          0    4765   797818          0
15015183      19     2279          0    1429   797720          0
33153097       1      116          0    1452   799883          0
21250581      16       37          0    1891   799962          0
avg           26     3795          0    2560   769515          0


## 优化（并行多流模式）， 在 单节点下测试
### 顶点批次10000。（由于阈值过高，导致2度下，并发度基本没有提升）
depth: 1  vid: 20727483  count: 973  {'edge_iters': 1107, 'vertice_iters': 2, 'cost': 8}
depth: 1  vid: 50329304  count: 4746  {'edge_iters': 4759, 'vertice_iters': 2, 'cost': 15}
depth: 1  vid: 26199460  count: 19954  {'edge_iters': 34771, 'vertice_iters': 2, 'cost': 62}
depth: 1  vid: 1177521  count: 4272  {'edge_iters': 4966, 'vertice_iters': 2, 'cost': 14}
depth: 1  vid: 27960125  count: 7  {'edge_iters': 8, 'vertice_iters': 2, 'cost': 9}
depth: 1  vid: 30440025  count: 3386  {'edge_iters': 3420, 'vertice_iters': 2, 'cost': 10}
depth: 1  vid: 15833920  count: 2181  {'edge_iters': 3317, 'vertice_iters': 2, 'cost': 10}
depth: 1  vid: 15015183  count: 2279  {'edge_iters': 3494, 'vertice_iters': 2, 'cost': 10}
depth: 1  vid: 33153097  count: 116  {'edge_iters': 142, 'vertice_iters': 2, 'cost': 4}
depth: 1  vid: 21250581  count: 37  {'edge_iters': 40, 'vertice_iters': 2, 'cost': 4}
depth: 2  vid: 20727483  count: 2874132  {'edge_iters': 3365761, 'vertice_iters': 1973, 'cost': 3445}
depth: 2  vid: 50329304  count: 2714697  {'edge_iters': 3486569, 'vertice_iters': 9505, 'cost': 3819}
depth: 2  vid: 26199460  count: 7818213  {'edge_iters': 105630343, 'vertice_iters': 41355, 'cost': 71343}
depth: 2  vid: 1177521  count: 19318826  {'edge_iters': 108995415, 'vertice_iters': 9744, 'cost': 103589}
depth: 2  vid: 27960125  count: 533108  {'edge_iters': 515600, 'vertice_iters': 21, 'cost': 619}
depth: 2  vid: 30440025  count: 11294131  {'edge_iters': 22395696, 'vertice_iters': 6992, 'cost': 20348}
depth: 2  vid: 15833920  count: 7858255  {'edge_iters': 24678958, 'vertice_iters': 4605, 'cost': 23715}
depth: 2  vid: 15015183  count: 5933114  {'edge_iters': 40889636, 'vertice_iters': 5004, 'cost': 35472}
depth: 2  vid: 33153097  count: 12181518  {'edge_iters': 27144301, 'vertice_iters': 524, 'cost': 22807}
depth: 2  vid: 21250581  count: 11063971  {'edge_iters': 17450718, 'vertice_iters': 332, 'cost': 22198}
          cost-1  count-1  iters/s-1  cost-2   count-2  iters/s-2
20727483       8      973     138625    3445   2874132     977571
50329304      15     4746     317400    3819   2714697     915442
26199460      62    19954     560854   71343   7818213    1481178
1177521       14     4272     354857  103589  19318826    1052285
27960125       9        7       1111     619    533108     832990
30440025      10     3386     342200   20348  11294131    1100977
15833920      10     2181     331900   23715   7858255    1040841
15015183      10     2279     349600   35472   5933114    1152870
33153097       4      116      36000   22807  12181518    1190197
21250581       4       37      10500   22198  11063971     786154
avg           14     3795     244304   30735   8158996    1053050

### 8并行流式，顶点批次1000 (单节点)
depth: 3  vid: 20727483  count: 27206364  {'edge_iters': 697715998, 'vertice_iters': 5645702, 'cost': 262634}
depth: 3  vid: 50329304  count: 29939224  {'edge_iters': 613875517, 'vertice_iters': 5336854, 'cost': 260877}
depth: 3  vid: 26199460  count: 31324331  {'edge_iters': 1307395331, 'vertice_iters': 15282743, 'cost': 536932}
depth: 3  vid: 1177521  count: 17139728  {'edge_iters': 1695281891, 'vertice_iters': 37579397, 'cost': 674090}
depth: 3  vid: 27960125  count: 20280156  {'edge_iters': 78743575, 'vertice_iters': 1032560, 'cost': 65827}
depth: 3  vid: 30440025  count: 23120608  {'edge_iters': 1280497542, 'vertice_iters': 21991568, 'cost': 495751}
depth: 3  vid: 15833920  count: 26263806  {'edge_iters': 1309487393, 'vertice_iters': 15390867, 'cost': 445710}
depth: 3  vid: 15015183  count: 27727528  {'edge_iters': 1159262130, 'vertice_iters': 11614138, 'cost': 414171}
depth: 3  vid: 33153097  count: 20512137  {'edge_iters': 1271287725, 'vertice_iters': 23748938, 'cost': 512903}
depth: 3  vid: 21250581  count: 20804933  {'edge_iters': 1132383352, 'vertice_iters': 21527268, 'cost': 484428}
          cost-1  count-1  iters/s-1  cost-2   count-2  iters/s-2  cost-3   count-3  iters/s-3
20727483       7      973     158428    3639   2874132     931256  262634  27206364    2678106
50329304      16     4746     297562    2199   2714697    1156627  260877  29939224    2373579
26199460      58    19954     599534   28719   7818213    1185249  536932  31324331    2463399
1177521       13     4272     382153   51464  19318826    1037710  674090  17139728    2570667
27960125       4        7       2500     575    533108     890144   65827  20280156    1211905
30440025       9     3386     380222   12426  11294131    1416040  495751  23120608    2627305
15833920       9     2181     368777   15979   7858255    1150153  445710  26263806    2972511
15015183      10     2279     349600   22159   5933114    1319036  414171  27727528    2827035
33153097       3      116      48000   23820  12181518    1133322  512903  20512137    2524915
21250581       4       37      10500   22695  11063971     944987  484428  20804933    2382006
avg           13     3795     259727   18367   8158996    1116452  415332  24431881    2463142

### 8并行多流（1万批次） + rocksdb多线程(cpu/8)，三节点
          cost-1  count-1  iters/s-1  cost-2   count-2  iters/s-2  cost-3   count-3  iters/s-3
20727483       7      973     158428    1611   2874132     987521  178417  27206363     737124
50329304      11     4746     432818    1477   2714697     865296  170664  29939223     831501
26199460      32    19954     864187   21488   7818213     686926  317098  31324330     737195
1177521       12     4272     414000   31878  19318826     514067  439754  17139727     652167
27960125       5        7       2000     353    533108    1045198   53682  20280156     443473
30440025      10     3386     342200   22527  11294131     169842  274010  23120607     822904
15833920      14     2181     237071    9489   7858255     345043  280074  26263805     705133
15015183       9     2279     388444    9581   5933114     499205  235075  27727527     823692
33153097       4      116      36000    7644  12181518     615780  248639  20512136     846587
21250581       4       37      10500   11612  11063971     938348  235001  20804932     834526
avg           10     3795     288564   11766   8158996     666722  243241  24431880     743430

### 8并行多流（1万批次） + rocksdb多线程(cpu/8)，单节点
          cost-1  count-1  iters/s-1  cost-2   count-2  iters/s-2  cost-3   count-3  iters/s-3
20727483      10      973     110900    1847   2874132    1158388  178677  27206364     950931
50329304      14     4746     340071    2260   2714697    1029822  194827  29939224     776140
26199460      39    19954     785102   25098   7818213     928281  306735  31324331     998978
1177521       46     4272     108000   45570  19318826    1052317  389747  17139728    1064587
27960125      10        7       1000     375    533108    1247658   58003  20280156     611762
30440025      13     3386     263230    8642  11294131    1126111  315219  23120608    1206558
15833920      34     2181      97617   13098   7858255     742545  254019  26263806    1322703
15015183      12     2279     291333   10990   5933114    1452453  254547  27727528    1040521
33153097       6      116      24000    9299  12181518     901467  263701  20512137    1209137
21250581       6       37       7000   16809  11063971    1032347  324296  20804933    1031633
avg           19     3795     202825   13398   8158996    1067138  253977  24431881    1021295

          cost-1  count-1  iters/s-1  cost-2   count-2  iters/s-2
20727483      54      973      20537    3280   2874132     705864
50329304      63     4746      75571    2452   2714697     944266
26199460      45    19954     622977   22022   7818213     717084
1177521       29     4272     171310   49505  19318826     293991
27960125     260        7         38     377    533108    1028570
30440025      42     3386      81476    6884  11294131     461496
15833920      28     2181     118535    8878   7858255     437762
15015183     172     2279      20325    8017   5933114     665768
33153097     157      116        917    7297  12181518     650180
21250581      26       37       1615   12880  11063971    1044914
avg           87     3795     111330   12159   8158996     694989


### store 切换 clib-malloc库后.
          cost-1  count-1  iters/s-1  cost-2   count-2  iters/s-2  cost-3   count-3  iters/s-3
20727483      38      973      29184    2091   2874132    1342519  114286  27206363    1197289
50329304      37     4746     128675    1924   2714697    1447810  121794  29939223    1155078
26199460      59    19954     569898   20183   7818213     797726  200733  31324330    1304253
1177521       31     4272     160258   19458  19318826     910216  311926  17139727    1093687
27960125      22        7        454     433    533108    1181489   25553  20280156    1022653
30440025      32     3386     106937    6333  11294131     973976  269065  23120607     926427
15833920      30     2181     110633    6404   7858255     766437  179227  26263805    1336795
15015183      32     2279     109250  101781   5933114      65775  168918  27727527    1279438
33153097      22      116       6545    7489  12181518    1147236  307899  20512136     756546
21250581      20       37       2100    8001  11063971    2096075  161141  20804932    1475277
avg           32     3795     122393   17409   8158996    1072925  186054  24431880    1154744

### store 切换 clib-malloc库后。 解决流关闭及对象释放后
          cost-1  count-1  iters/s-1  cost-2   count-2  iters/s-2    cost-3    count-3  iters/s-3
20727483       8      973     138625    1838   2874132     899767    126271   27206363    1306200
50329304      24     4746     198375    1795   2714697    1290125    123995   29939223    1284780
26199460      45    19954     752644   15767   7818213    1299703    207986   31324330    1413231
1177521       13     4272     382153   19328  19318826    1231707    255750   17139467    1208429
27960125       4        7       2500     420    533108    1230371     29347   20280156     889238
30440025      11     3386     311090    8505  11294131     721933    203294   23120607    1393334
15833920      10     2181     331900    6668   7858255     677859    176834   26263805    1605905
15015183      11     2279     317818    7575   5933114    1011677    165594   27727527    1440761
33153097       4      116      36000    7778  12181518     977675    234264   20512136    1171053
21250581       5       37       8400    9303  11063971    1974533    184173   20804932    1289760
avg           13     3795     247950    7897   8158996    1131535    170750   24431854    1300269

### store 切换 clib-malloc库后。 解决流关闭及对象释放后。 重新测试
          cost-1  count-1  iters/s-1  cost-2   count-2  iters/s-2  cost-3   count-3  iters/s-3
20727483     142      973      15387    1928   2874132     801314  116170  27206363    1626461
50329304      55     4746     171745    2027   2714697    1226806  122968  29939223    1494316
26199460     115    19954     338226   16649   7818213    1339436  201856  31324330    1691565
1177521       37     4272     268216   22156  19318826    1006522  331826  17139727    1150183
27960125       7        7       2714     379    533108    1341899   28796  20280156    1069351
30440025      20     3386     328800    7232  11294131     861387  197634  23120607    1611848
15833920      16     2181     414750    7766   7858255     758150  246926  26263805    1204685
15015183      19     2279     349631    7883   5933114     975673  176229  27727527    1472830
33153097       7      116      41000    6874  12181518    1011072  201823  20512136    1397928
21250581       6       37      13833    9098  11063971    1841285  202219  20804932    1422835
avg           42     3795     194430    8199   8158996    1116354  182644  24431880    1414200
